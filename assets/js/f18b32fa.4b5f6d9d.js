"use strict";(self.webpackChunkpluto=self.webpackChunkpluto||[]).push([[6890],{3905:(e,t,o)=>{o.d(t,{Zo:()=>p,kt:()=>F});var a=o(7294);function l(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function n(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){l(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,a,l=function(e,t){if(null==e)return{};var o,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(l[o]=e[o]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(l[o]=e[o])}return l}var c=a.createContext({}),i=function(e){var t=a.useContext(c),o=t;return e&&(o="function"==typeof e?e(t):n(n({},t),e)),o},p=function(e){var t=i(e.components);return a.createElement(c.Provider,{value:t},e.children)},d="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var o=e.components,l=e.mdxType,r=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=i(o),m=l,F=d["".concat(c,".").concat(m)]||d[m]||k[m]||r;return o?a.createElement(F,n(n({ref:t},p),{},{components:o})):a.createElement(F,n({ref:t},p))}));function F(e,t){var o=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=o.length,n=new Array(r);n[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[d]="string"==typeof e?e:l,n[1]=s;for(var i=2;i<r;i++)n[i]=o[i];return a.createElement.apply(null,n)}return a.createElement.apply(null,o)}m.displayName="MDXCreateElement"},5957:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>n,default:()=>k,frontMatter:()=>r,metadata:()=>s,toc:()=>i});var a=o(7462),l=(o(7294),o(3905));const r={sidebar_position:3},n=void 0,s={unversionedId:"Runtime Environment/Socket",id:"Runtime Environment/Socket",title:"Socket",description:"Must be included via require. This library is not available in WASM builds of Pluto.",source:"@site/docs/Runtime Environment/Socket.md",sourceDirName:"Runtime Environment",slug:"/Runtime Environment/Socket",permalink:"/docs/Runtime Environment/Socket",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Scheduler",permalink:"/docs/Runtime Environment/Scheduler"},next:{title:"URL",permalink:"/docs/Runtime Environment/URL"}},c={},i=[{value:"<code>socket.connect</code>",id:"socketconnect",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Returns",id:"returns",level:4},{value:"Multitasking",id:"multitasking",level:4},{value:"<code>socket.listen</code>",id:"socketlisten",level:3},{value:"Parameters",id:"parameters-1",level:4},{value:"Returns",id:"returns-1",level:4},{value:"<code>socket.bind</code>",id:"socketbind",level:3},{value:"Parameters",id:"parameters-2",level:4},{value:"Socket Class",id:"socket-class",level:2},{value:"<code>socket.send</code>",id:"socketsend",level:3},{value:"Parameters",id:"parameters-3",level:4},{value:"<code>socket.recv</code>",id:"socketrecv",level:3},{value:"Parameters",id:"parameters-4",level:4},{value:"Returns",id:"returns-2",level:4},{value:"Multitasking",id:"multitasking-1",level:4},{value:"<code>socket.unrecv</code>",id:"socketunrecv",level:3},{value:"Parameters",id:"parameters-5",level:4},{value:"<code>socket.starttls</code>",id:"socketstarttls",level:3},{value:"Parameters",id:"parameters-6",level:4},{value:"Returns",id:"returns-3",level:4},{value:"Multitasking",id:"multitasking-2",level:4},{value:"<code>socket.close</code>",id:"socketclose",level:3},{value:"Parameters",id:"parameters-7",level:4},{value:"Listener Class",id:"listener-class",level:2},{value:"<code>accept</code>",id:"accept",level:3},{value:"Returns",id:"returns-4",level:4},{value:"Multitasking",id:"multitasking-3",level:4},{value:"<code>hasconnection</code>",id:"hasconnection",level:3}],p={toc:i},d="wrapper";function k(e){let{components:t,...o}=e;return(0,l.kt)(d,(0,a.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Must be included via ",(0,l.kt)("inlineCode",{parentName:"p"},"require"),". This library is not available in WASM builds of Pluto."),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"socketconnect"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.connect")),(0,l.kt)("p",null,"Establishes a TCP connection."),(0,l.kt)("h4",{id:"parameters"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The host to connect to. Either an IPv4 or IPv6 address, or a domain name resolving to one."),(0,l.kt)("li",{parentName:"ol"},"The port to contact the host on.")),(0,l.kt)("h4",{id:"returns"},"Returns"),(0,l.kt)("p",null,"A socket instance on success. Nil on failure."),(0,l.kt)("h4",{id:"multitasking"},"Multitasking"),(0,l.kt)("p",null,"If called inside of a coroutine, this function yields. Otherwise, it blocks."),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"socketlisten"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.listen")),(0,l.kt)("p",null,"Creates a new listener for the given port."),(0,l.kt)("h4",{id:"parameters-1"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The port to listen on.")),(0,l.kt)("h4",{id:"returns-1"},"Returns"),(0,l.kt)("p",null,"A listener instance on success. Nil on failure."),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"socketbind"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.bind")),(0,l.kt)("p",null,"A convenience function that wraps ",(0,l.kt)("inlineCode",{parentName:"p"},"socket.listen"),", automatically accepting new clients and spinning up a coroutine for them."),(0,l.kt)("h4",{id:"parameters-2"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"A ",(0,l.kt)("a",{parentName:"li",href:"Scheduler"},"scheduler")," instance."),(0,l.kt)("li",{parentName:"ol"},"The port to listen on."),(0,l.kt)("li",{parentName:"ol"},"The callback function that will be called in a new coroutine for each client socket.")),(0,l.kt)("pre",{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"}},(0,l.kt)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.kt)("div",{parentName:"pre",className:"code-container"},(0,l.kt)("code",{parentName:"div"},(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," { scheduler"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},","),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket } "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"require"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"*"')),(0,l.kt)("div",{parentName:"code",className:"line"}),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," sched "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"new"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF",fontStyle:"italic"}},"scheduler"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"()")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"socket"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},"."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"bind"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"(sched"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},","),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"80"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},","),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," |"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #FD971F",fontStyle:"italic"}},"s"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"| "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF",fontStyle:"italic"}},"->"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"do")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"    "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," content "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"Hello, world!"')),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"    s"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"send"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"HTTP/1.1 200 OK'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},"Connection: Close"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'Content-Length: "'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"..#"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"content"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},".."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},".."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"content)")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"end"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"sched"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"run"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"()"))))),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"socket-class"},"Socket Class"),(0,l.kt)("p",null,"Socket instances are obtained by calling ",(0,l.kt)("inlineCode",{parentName:"p"},"socket.connect")," (client), or from a listener (server)."),(0,l.kt)("h3",{id:"socketsend"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.send")),(0,l.kt)("p",null,"Sends data on a socket."),(0,l.kt)("h4",{id:"parameters-3"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The socket instance."),(0,l.kt)("li",{parentName:"ol"},"The data to send.")),(0,l.kt)("h3",{id:"socketrecv"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.recv")),(0,l.kt)("p",null,"Receive data from a socket."),(0,l.kt)("h4",{id:"parameters-4"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The socket instance.")),(0,l.kt)("h4",{id:"returns-2"},"Returns"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"If the socket is open: The oldest chunk of data received on the transport layer (TCP packet) or crypto layer (TLS record) as a string."),(0,l.kt)("li",{parentName:"ul"},"If the socket is closed: Nil.")),(0,l.kt)("h4",{id:"multitasking-1"},"Multitasking"),(0,l.kt)("p",null,"If a message is buffered, the function can return immediately. If not, it will yield if inside a coroutine, and block otherwise."),(0,l.kt)("pre",{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"}},(0,l.kt)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.kt)("div",{parentName:"pre",className:"code-container"},(0,l.kt)("code",{parentName:"div"},(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"require"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"pluto:socket"')),(0,l.kt)("div",{parentName:"code",className:"line"}),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," s "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},"."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"connect"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"google.com"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},","),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"80"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"s"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"send"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"GET / HTTP/1.1'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},"Host: google.com"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"print"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"(s"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"recv"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"())"))))),(0,l.kt)("h3",{id:"socketunrecv"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.unrecv")),(0,l.kt)("p",null,"Pushes a chunk of data to the front of the receive buffer, making it oldest for the purposes of ",(0,l.kt)("inlineCode",{parentName:"p"},"socket.recv"),"."),(0,l.kt)("h4",{id:"parameters-5"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The socket instance."),(0,l.kt)("li",{parentName:"ol"},"The data to push.")),(0,l.kt)("pre",{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"}},(0,l.kt)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.kt)("div",{parentName:"pre",className:"code-container"},(0,l.kt)("code",{parentName:"div"},(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"require"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"pluto:socket"')),(0,l.kt)("div",{parentName:"code",className:"line"}),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," sock "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},"."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"connect"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"google.com"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},","),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"80"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"sock"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"unrecv"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"World"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"sock"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"unrecv"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"Hello"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"print"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"(sock"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"recv"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"()) "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #88846F"}},"--\x3e Hello")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"print"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"(sock"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"recv"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"()) "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #88846F"}},"--\x3e World"))))),(0,l.kt)("h3",{id:"socketstarttls"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.starttls")),(0,l.kt)("p",null,"Attempts to add the TLS crypto layer to the socket, making the transport layer a sole carrier for TLS traffic."),(0,l.kt)("h4",{id:"parameters-6"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The socket instance."),(0,l.kt)("li",{parentName:"ol"},"The host name of the intended remote. This may be the same as what was passed to ",(0,l.kt)("inlineCode",{parentName:"li"},"socket.connect"),". This name must be on the certificate that the remote will send.")),(0,l.kt)("h4",{id:"returns-3"},"Returns"),(0,l.kt)("p",null,"True on success. On failure, returns false and the socket is closed. If the socket is already using TLS, returns nil."),(0,l.kt)("h4",{id:"multitasking-2"},"Multitasking"),(0,l.kt)("p",null,"If called inside of a coroutine, this function yields. Otherwise, it blocks."),(0,l.kt)("pre",{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"}},(0,l.kt)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.kt)("div",{parentName:"pre",className:"code-container"},(0,l.kt)("code",{parentName:"div"},(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"require"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"pluto:socket"')),(0,l.kt)("div",{parentName:"code",className:"line"}),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," s "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},"."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"connect"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"pluto-lang.org"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},","),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"443"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"assert"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"(s"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"starttls"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"pluto-lang.org"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},","),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"Failed to establish secure connection."'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"s"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"send"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"GET / HTTP/1.1'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},"Host: pluto-lang.org"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},"Connection: close"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"\\r\\n\\r\\n"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"while"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," data "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},":="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," s"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"recv"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"() "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"do")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"    "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"print"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"(data)")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"end"))))),(0,l.kt)("h3",{id:"socketclose"},(0,l.kt)("inlineCode",{parentName:"h3"},"socket.close")),(0,l.kt)("p",null,"Closes a socket."),(0,l.kt)("h4",{id:"parameters-7"},"Parameters"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"The socket instance.")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"listener-class"},"Listener Class"),(0,l.kt)("p",null,"Listener instances are obtained by calling ",(0,l.kt)("inlineCode",{parentName:"p"},"socket.listen"),"."),(0,l.kt)("h3",{id:"accept"},(0,l.kt)("inlineCode",{parentName:"h3"},"accept")),(0,l.kt)("p",null,"Accepts an incoming client connection, waiting until there is one."),(0,l.kt)("h4",{id:"returns-4"},"Returns"),(0,l.kt)("p",null,"A new socket instance. The socket can be used as per usual, with the exception of the starttls function being unavailable."),(0,l.kt)("h4",{id:"multitasking-3"},"Multitasking"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"If there is an incoming client connection, this function returns immediately."),(0,l.kt)("li",{parentName:"ul"},"If there is not, it waits for one. Waiting means yielding if called inside a coroutine, and blocking otherwise.")),(0,l.kt)("h3",{id:"hasconnection"},(0,l.kt)("inlineCode",{parentName:"h3"},"hasconnection")),(0,l.kt)("p",null,"Checks if there is an incoming client connection. If this function returns true, the next call to ",(0,l.kt)("inlineCode",{parentName:"p"},"accept")," is guaranteed not to block or yield."),(0,l.kt)("pre",{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"}},(0,l.kt)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.kt)("div",{parentName:"pre",className:"code-container"},(0,l.kt)("code",{parentName:"div"},(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"require"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"pluto:socket"')),(0,l.kt)("div",{parentName:"code",className:"line"}),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"local"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," l "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"="),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," socket"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},"."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"listen"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"80"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},") "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"or"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"error"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #E6DB74"}},'"Failed to bind TCP/80"'),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"while"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"not"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," l"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"hasconnection"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"() "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"do"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}}," "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #88846F"}},"-- Visit http://localhost to break this loop")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"    "),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"os"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},"."),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"sleep"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"("),(0,l.kt)("span",{parentName:"div",style:{color:"color: #AE81FF"}},"1"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},")")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #F92672"}},"end")),(0,l.kt)("div",{parentName:"code",className:"line"},(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"print"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"(l"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"accept"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"()"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #9F570F"}},":"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #66D9EF"}},"recv"),(0,l.kt)("span",{parentName:"div",style:{color:"color: #F8F8F2"}},"())"))))))}k.isMDXComponent=!0}}]);