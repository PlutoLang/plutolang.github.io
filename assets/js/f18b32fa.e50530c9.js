"use strict";(self.webpackChunkpluto=self.webpackChunkpluto||[]).push([[7666],{5680:(e,a,t)=>{t.d(a,{xA:()=>y,yg:()=>m});var n=t(6540);function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){l(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,n,l=function(e,a){if(null==e)return{};var t,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=n.createContext({}),i=function(e){var a=n.useContext(p),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},y=function(e){var a=i(e.components);return n.createElement(p.Provider,{value:a},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},F=n.forwardRef((function(e,a){var t=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,y=s(e,["components","mdxType","originalType","parentName"]),c=i(t),F=l,m=c["".concat(p,".").concat(F)]||c[F]||d[F]||r;return t?n.createElement(m,o(o({ref:a},y),{},{components:t})):n.createElement(m,o({ref:a},y))}));function m(e,a){var t=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var r=t.length,o=new Array(r);o[0]=F;var s={};for(var p in a)hasOwnProperty.call(a,p)&&(s[p]=a[p]);s.originalType=e,s[c]="string"==typeof e?e:l,o[1]=s;for(var i=2;i<r;i++)o[i]=t[i];return n.createElement.apply(null,o)}return n.createElement.apply(null,t)}F.displayName="MDXCreateElement"},8663:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>i});var n=t(8168),l=(t(6540),t(5680));const r={},o=void 0,s={unversionedId:"Runtime Environment/Socket",id:"Runtime Environment/Socket",title:"Socket",description:"Must be included via require. This library is not available in WASM builds of Pluto.",source:"@site/docs/Runtime Environment/Socket.md",sourceDirName:"Runtime Environment",slug:"/Runtime Environment/Socket",permalink:"/docs/Runtime Environment/Socket",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Scheduler",permalink:"/docs/Runtime Environment/Scheduler"},next:{title:"String",permalink:"/docs/Runtime Environment/String"}},p={},i=[{value:"<code>socket.connect</code>",id:"socketconnect",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Returns",id:"returns",level:4},{value:"Multitasking",id:"multitasking",level:4},{value:"<code>socket.listen</code>",id:"socketlisten",level:3},{value:"Parameters",id:"parameters-1",level:4},{value:"Returns",id:"returns-1",level:4},{value:"<code>socket.bind</code>",id:"socketbind",level:3},{value:"Parameters",id:"parameters-2",level:4},{value:"Socket Class",id:"socket-class",level:2},{value:"<code>socket.send</code>",id:"socketsend",level:3},{value:"Parameters",id:"parameters-3",level:4},{value:"<code>socket.recv</code>",id:"socketrecv",level:3},{value:"Parameters",id:"parameters-4",level:4},{value:"Returns",id:"returns-2",level:4},{value:"Multitasking",id:"multitasking-1",level:4},{value:"<code>socket.peek</code>",id:"socketpeek",level:3},{value:"Parameters",id:"parameters-5",level:4},{value:"Returns",id:"returns-3",level:4},{value:"<code>socket.unrecv</code>",id:"socketunrecv",level:3},{value:"Parameters",id:"parameters-6",level:4},{value:"<code>socket.starttls</code>",id:"socketstarttls",level:3},{value:"Parameters (Client)",id:"parameters-client",level:4},{value:"Parameters (Server)",id:"parameters-server",level:4},{value:"Returns",id:"returns-4",level:4},{value:"Multitasking",id:"multitasking-2",level:4},{value:"<code>socket.close</code>",id:"socketclose",level:3},{value:"Parameters",id:"parameters-7",level:4},{value:"<code>socket.getpeer</code>",id:"socketgetpeer",level:3},{value:"Parameters",id:"parameters-8",level:4},{value:"Returns",id:"returns-5",level:4},{value:"<code>socket.getside</code>",id:"socketgetside",level:3},{value:"Parameters",id:"parameters-9",level:4},{value:"Returns",id:"returns-6",level:4},{value:"<code>socket.istls</code>",id:"socketistls",level:3},{value:"Parameters",id:"parameters-10",level:4},{value:"<code>socket.isopen</code>",id:"socketisopen",level:3},{value:"Parameters",id:"parameters-11",level:4},{value:"Listener Class",id:"listener-class",level:2},{value:"<code>accept</code>",id:"accept",level:3},{value:"Returns",id:"returns-7",level:4},{value:"Multitasking",id:"multitasking-3",level:4},{value:"<code>hasconnection</code>",id:"hasconnection",level:3}],y={toc:i},c="wrapper";function d(e){let{components:a,...t}=e;return(0,l.yg)(c,(0,n.A)({},y,t,{components:a,mdxType:"MDXLayout"}),(0,l.yg)("p",null,"Must be included via ",(0,l.yg)("inlineCode",{parentName:"p"},"require"),". This library is not available in WASM builds of Pluto."),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"socketconnect"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.connect")),(0,l.yg)("p",null,"Establishes a TCP connection."),(0,l.yg)("h4",{id:"parameters"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The host to connect to. Either an IPv4 or IPv6 address, or a domain name resolving to one."),(0,l.yg)("li",{parentName:"ol"},"The port to contact the host on.")),(0,l.yg)("h4",{id:"returns"},"Returns"),(0,l.yg)("p",null,"A socket instance on success. Nil on failure."),(0,l.yg)("h4",{id:"multitasking"},"Multitasking"),(0,l.yg)("p",null,"If called inside of a coroutine, this function yields. Otherwise, it blocks."),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"socketlisten"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.listen")),(0,l.yg)("p",null,"Creates a new listener for the given port."),(0,l.yg)("h4",{id:"parameters-1"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The port to listen on.")),(0,l.yg)("h4",{id:"returns-1"},"Returns"),(0,l.yg)("p",null,"A listener instance on success. Nil on failure."),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"socketbind"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.bind")),(0,l.yg)("p",null,"A convenience function that wraps ",(0,l.yg)("inlineCode",{parentName:"p"},"socket.listen"),", automatically accepting new clients and spinning up a coroutine for them."),(0,l.yg)("h4",{id:"parameters-2"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"A ",(0,l.yg)("a",{parentName:"li",href:"Scheduler"},"scheduler")," instance."),(0,l.yg)("li",{parentName:"ol"},"The port to listen on."),(0,l.yg)("li",{parentName:"ol"},"The callback function that will be called in a new coroutine for each client socket.")),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," { scheduler"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket } "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"*"')),(0,l.yg)("div",{parentName:"code",className:"line"}),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sched "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"new"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF",fontStyle:"italic"}},"scheduler"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"socket"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"bind"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sched"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"80"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," |"),(0,l.yg)("span",{parentName:"div",style:{color:"#FD971F",fontStyle:"italic"}},"s"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"| "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF",fontStyle:"italic"}},"->"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"do")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," content "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"Hello, world!"')),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"send"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"HTTP/1.1 200 OK'),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},"Connection: Close"),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'Content-Length: "'),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"..#"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"content"),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},".."),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"'),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},".."),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"content)")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"end"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"sched"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"run"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()"))))),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"socket-class"},"Socket Class"),(0,l.yg)("p",null,"Socket instances are obtained by calling ",(0,l.yg)("inlineCode",{parentName:"p"},"socket.connect")," (client), or from a listener (server)."),(0,l.yg)("h3",{id:"socketsend"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.send")),(0,l.yg)("p",null,"Sends data on a socket."),(0,l.yg)("h4",{id:"parameters-3"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance."),(0,l.yg)("li",{parentName:"ol"},"The data to send.")),(0,l.yg)("h3",{id:"socketrecv"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.recv")),(0,l.yg)("p",null,"Receive data from a socket."),(0,l.yg)("h4",{id:"parameters-4"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance.")),(0,l.yg)("h4",{id:"returns-2"},"Returns"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"If the socket is open: The oldest chunk of data received on the transport layer (TCP packet) or crypto layer (TLS record) as a string."),(0,l.yg)("li",{parentName:"ul"},"If the socket is closed: Nil.")),(0,l.yg)("h4",{id:"multitasking-1"},"Multitasking"),(0,l.yg)("p",null,"If a message is buffered, the function can return immediately. If not, it will yield if inside a coroutine, and block otherwise."),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"pluto:socket"')),(0,l.yg)("div",{parentName:"code",className:"line"}),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," s "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"connect"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"google.com"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"80"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"send"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"GET / HTTP/1.1'),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},"Host: google.com"),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"recv"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"())"))))),(0,l.yg)("h3",{id:"socketpeek"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.peek")),(0,l.yg)("p",null,"Look at received data without consuming it."),(0,l.yg)("h4",{id:"parameters-5"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instances.")),(0,l.yg)("h4",{id:"returns-3"},"Returns"),(0,l.yg)("p",null,"Either the string that would be returned next by ",(0,l.yg)("inlineCode",{parentName:"p"},"socket.recv")," or nothing if there is no message in the receive buffer."),(0,l.yg)("h3",{id:"socketunrecv"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.unrecv")),(0,l.yg)("p",null,"Pushes a chunk of data to the front of the receive buffer, making it oldest for the purposes of ",(0,l.yg)("inlineCode",{parentName:"p"},"socket.recv"),"."),(0,l.yg)("h4",{id:"parameters-6"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance."),(0,l.yg)("li",{parentName:"ol"},"The data to push.")),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"pluto:socket"')),(0,l.yg)("div",{parentName:"code",className:"line"}),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sock "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"connect"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"google.com"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"80"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"unrecv"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"World"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"unrecv"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"Hello"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"recv"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e Hello")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"recv"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e World"))))),(0,l.yg)("h3",{id:"socketstarttls"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.starttls")),(0,l.yg)("p",null,"Attempts to add the TLS crypto layer to the socket, making the transport layer a sole carrier for TLS traffic."),(0,l.yg)("h4",{id:"parameters-client"},"Parameters (Client)"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance."),(0,l.yg)("li",{parentName:"ol"},"The host name of the intended remote. This may be the same as what was passed to ",(0,l.yg)("inlineCode",{parentName:"li"},"socket.connect"),". This name must be on the certificate that the remote will send.")),(0,l.yg)("h4",{id:"parameters-server"},"Parameters (Server)"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance."),(0,l.yg)("li",{parentName:"ol"},"An array of tables describing available certificates. Each certificate needs a ",(0,l.yg)("inlineCode",{parentName:"li"},"chain")," and ",(0,l.yg)("inlineCode",{parentName:"li"},"private_key")," field, which should be a string containing valid PEM. The ",(0,l.yg)("inlineCode",{parentName:"li"},"private_key")," must be RSA.")),(0,l.yg)("h4",{id:"returns-4"},"Returns"),(0,l.yg)("p",null,"True on success. On failure, returns false and the socket is closed. If the socket is already using TLS, returns nil."),(0,l.yg)("h4",{id:"multitasking-2"},"Multitasking"),(0,l.yg)("p",null,"If called inside of a coroutine, this function yields. Otherwise, it blocks."),(0,l.yg)("pre",{className:"shiki monokai-patched with-title",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true",title:"Client Example"},(0,l.yg)("div",{parentName:"pre",className:"code-title"},"Client Example"),(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"pluto:socket"')),(0,l.yg)("div",{parentName:"code",className:"line"}),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," s "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"connect"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"pluto-lang.org"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"443"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"assert"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"starttls"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"pluto-lang.org"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"Failed to establish secure connection."'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"send"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"GET / HTTP/1.1'),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},"Host: pluto-lang.org"),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},"Connection: close"),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"while"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," data "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},":="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"recv"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"() "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"do")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(data)")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"end"))))),(0,l.yg)("pre",{className:"shiki monokai-patched with-title",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true",title:"Server Example"},(0,l.yg)("div",{parentName:"pre",className:"code-title"},"Server Example"),(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," { http"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," scheduler"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket } "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"*"')),(0,l.yg)("div",{parentName:"code",className:"line"}),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," certs "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," {")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    {")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"        chain "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," http"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"request"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"https://tls.cat/certs/viatls-2024/cert.pem"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},",")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"        private_key "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," http"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"request"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"https://tls.cat/certs/viatls-2024/key.pem"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},",")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    }")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"}")),(0,l.yg)("div",{parentName:"code",className:"line"}),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sched "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"new"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF",fontStyle:"italic"}},"scheduler"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"socket"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"bind"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sched"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"443"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," |"),(0,l.yg)("span",{parentName:"div",style:{color:"#FD971F",fontStyle:"italic"}},"s"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"| "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF",fontStyle:"italic"}},"->"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"do")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"if"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"starttls"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(certs) "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"then")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"        "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," content "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"Hello, world!"')),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"        s"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"send"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"HTTP/1.1 200 OK'),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},"Connection: Close"),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'Content-Length: "'),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"..#"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"content"),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},".."),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"'),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"\\r\\n\\r\\n"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},".."),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"content)")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"end")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"end"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"https://127-0-0-1.viatls.com/"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"sched"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"run"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()"))))),(0,l.yg)("h3",{id:"socketclose"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.close")),(0,l.yg)("p",null,"Closes a socket."),(0,l.yg)("h4",{id:"parameters-7"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance.")),(0,l.yg)("h3",{id:"socketgetpeer"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.getpeer")),(0,l.yg)("p",null,"Get information about the other end of a connection."),(0,l.yg)("h4",{id:"parameters-8"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance.")),(0,l.yg)("h4",{id:"returns-5"},"Returns"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The IP address as a string."),(0,l.yg)("li",{parentName:"ol"},"The port.")),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sock "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"socket"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"connect"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"1.1.1.1"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"443"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," ip"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," port "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"getpeer"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(ip) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e 1.1.1.1")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(port) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e 443"))))),(0,l.yg)("h3",{id:"socketgetside"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.getside")),(0,l.yg)("p",null,"Get which side of the connection a socket is."),(0,l.yg)("h4",{id:"parameters-9"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance.")),(0,l.yg)("h4",{id:"returns-6"},"Returns"),(0,l.yg)("p",null,'Either "client" or "server".'),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sock "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"socket"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"connect"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"1.1.1.1"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"443"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"getside"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e client"))))),(0,l.yg)("h3",{id:"socketistls"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.istls")),(0,l.yg)("p",null,"Check if a connection is encrypted."),(0,l.yg)("h4",{id:"parameters-10"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance.")),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sock "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"socket"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"connect"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"1.1.1.1"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"443"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"istls"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e false")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"assert"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"starttls"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"1.1.1.1"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"))")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"istls"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e true"))))),(0,l.yg)("h3",{id:"socketisopen"},(0,l.yg)("inlineCode",{parentName:"h3"},"socket.isopen")),(0,l.yg)("p",null,"Check if a connection is still open."),(0,l.yg)("h4",{id:"parameters-11"},"Parameters"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"The socket instance.")),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," sock "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"socket"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"connect"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"1.1.1.1"'),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},","),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"443"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"isopen"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e true")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"close"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(sock"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"isopen"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()) "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"--\x3e false"))))),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"listener-class"},"Listener Class"),(0,l.yg)("p",null,"Listener instances are obtained by calling ",(0,l.yg)("inlineCode",{parentName:"p"},"socket.listen"),"."),(0,l.yg)("h3",{id:"accept"},(0,l.yg)("inlineCode",{parentName:"h3"},"accept")),(0,l.yg)("p",null,"Accepts an incoming client connection, waiting until there is one."),(0,l.yg)("h4",{id:"returns-7"},"Returns"),(0,l.yg)("p",null,"A new socket instance. The socket can be used as per usual, with the exception of the starttls function being unavailable."),(0,l.yg)("h4",{id:"multitasking-3"},"Multitasking"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"If there is an incoming client connection, this function returns immediately."),(0,l.yg)("li",{parentName:"ul"},"If there is not, it waits for one. Waiting means yielding if called inside a coroutine, and blocking otherwise.")),(0,l.yg)("h3",{id:"hasconnection"},(0,l.yg)("inlineCode",{parentName:"h3"},"hasconnection")),(0,l.yg)("p",null,"Checks if there is an incoming client connection. If this function returns true, the next call to ",(0,l.yg)("inlineCode",{parentName:"p"},"accept")," is guaranteed not to block or yield."),(0,l.yg)("pre",{className:"shiki monokai-patched",style:{backgroundColor:"#272822",color:"#F8F8F2"},norun:"true"},(0,l.yg)("div",{parentName:"pre",className:"language-id"},"pluto"),(0,l.yg)("div",{parentName:"pre",className:"code-container"},(0,l.yg)("code",{parentName:"div"},(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"require"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"pluto:socket"')),(0,l.yg)("div",{parentName:"code",className:"line"}),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"local"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," l "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"="),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," socket"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"listen"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"80"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},") "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"or"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"error"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#E6DB74"}},'"Failed to bind TCP/80"'),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"while"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"not"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," l"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"hasconnection"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"() "),(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"do"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}}," "),(0,l.yg)("span",{parentName:"div",style:{color:"#88846F"}},"-- Visit http://localhost to break this loop")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"    "),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"os"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},"."),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"sleep"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"("),(0,l.yg)("span",{parentName:"div",style:{color:"#AE81FF"}},"1"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},")")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#F92672"}},"end")),(0,l.yg)("div",{parentName:"code",className:"line"},(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"print"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"(l"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"accept"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"()"),(0,l.yg)("span",{parentName:"div",style:{color:"#9F570F"}},":"),(0,l.yg)("span",{parentName:"div",style:{color:"#66D9EF"}},"recv"),(0,l.yg)("span",{parentName:"div",style:{color:"#F8F8F2"}},"())"))))))}d.isMDXComponent=!0}}]);