"use strict";(self.webpackChunkpluto=self.webpackChunkpluto||[]).push([[8783],{8453:(s,l,e)=>{e.d(l,{R:()=>r,x:()=>i});var n=e(6540);const c={},o=n.createContext(c);function r(s){const l=n.useContext(o);return n.useMemo((function(){return"function"==typeof s?s(l):{...l,...s}}),[l,s])}function i(s){let l;return l=s.disableParentContext?"function"==typeof s.components?s.components(c):s.components||c:r(s.components),n.createElement(o.Provider,{value:l},s.children)}},8493:(s,l,e)=>{e.r(l),e.d(l,{assets:()=>a,contentTitle:()=>i,default:()=>F,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"New Features/Preprocessing","title":"Preprocessing","description":"Pluto provides some powerful constructs which allow you to write code that will never be seen at runtime.","source":"@site/docs/New Features/Preprocessing.md","sourceDirName":"New Features","slug":"/New Features/Preprocessing","permalink":"/docs/New Features/Preprocessing","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Nodiscard Functions","permalink":"/docs/New Features/Nodiscard Functions"},"next":{"title":"Safe Navigation","permalink":"/docs/New Features/Safe Navigation"}}');var c=e(4848),o=e(8453);const r={sidebar_position:2},i=void 0,a={},d=[{value:"Function calls",id:"function-calls",level:2},{value:"Variables",id:"variables",level:2},{value:"Conditionals",id:"conditionals",level:2},{value:"Aliases",id:"aliases",level:2}];function t(s){const l={code:"code",div:"div",h2:"h2",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...(0,o.R)(),...s.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.p,{children:"Pluto provides some powerful constructs which allow you to write code that will never be seen at runtime."}),"\n",(0,c.jsx)(l.h2,{id:"function-calls",children:"Function calls"}),"\n",(0,c.jsx)(l.p,{children:'Certain standard library functions can be called at compile-time, as long as the arguments are also known at compile-time, by using the "$" symbol before the function call.'}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},showlinenumbers:"true",children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsxs)(l.code,{children:[(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"local"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" runtime "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"require"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"crypto"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"}),(0,c.jsx)(l.span,{style:{color:"#9F570F"},children:"."}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"joaat"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"Hello, World!"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"local"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" compile "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"crypto"}),(0,c.jsx)(l.span,{style:{color:"#9F570F"},children:"."}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"joaat"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"Hello, World!"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"})]}),(0,c.jsx)(l.div,{className:"line"}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"assert"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"(runtime "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"=="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" compile)"})]})]})})]}),"\n",(0,c.jsx)(l.p,{children:"If you're unfamiliar with compile-time evaluation, this is essentially what the code turns into:"}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},showlinenumbers:"true",children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsxs)(l.code,{children:[(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"local"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" runtime "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"require"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"crypto"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"}),(0,c.jsx)(l.span,{style:{color:"#9F570F"},children:"."}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"joaat"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"Hello, World!"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"local"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" compile "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"847757641"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#88846F"},children:'-- The JOAAT hash of "Hello, World!"'})]}),(0,c.jsx)(l.div,{className:"line"}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"assert"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"(runtime "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"=="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" compile)"})]})]})})]}),"\n",(0,c.jsx)(l.p,{children:"This is available on preloaded Pluto libraries, such as:"}),"\n",(0,c.jsxs)(l.ul,{children:["\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"base32"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"base58"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"base64"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"crypto"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"json"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"url"})}),"\n"]}),"\n",(0,c.jsx)(l.p,{children:"And on the following functions:"}),"\n",(0,c.jsxs)(l.ul,{children:["\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"io.contents"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"tostring"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"utostring"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"tonumber"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"utonumber"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"type"})}),"\n",(0,c.jsx)(l.li,{children:(0,c.jsx)(l.code,{children:"assert"})}),"\n"]}),"\n",(0,c.jsx)(l.h2,{id:"variables",children:"Variables"}),"\n",(0,c.jsxs)(l.p,{children:["Compile-time constant variables can be defined via the ",(0,c.jsx)(l.code,{children:"$define"})," statement:"]}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsx)(l.code,{children:(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$define"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" a "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"123"})]})})})]}),"\n",(0,c.jsx)(l.p,{children:"This may seem identical to a local declared with the const attribute:"}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsx)(l.code,{children:(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"local"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" a "}),(0,c.jsx)(l.span,{style:{color:"#66D9EF",fontStyle:"italic"},children:"<const>"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"123"})]})})})]}),"\n",(0,c.jsxs)(l.p,{children:["However, ",(0,c.jsx)(l.code,{children:"$define"})," also enforces that the assigned variable is a compile-time constant:"]}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsxs)(l.code,{children:[(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"local"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" a "}),(0,c.jsx)(l.span,{style:{color:"#66D9EF",fontStyle:"italic"},children:"<const>"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" {}"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$define"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" a "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" {} "}),(0,c.jsx)(l.span,{style:{color:"#88846F"},children:"-- Error: variable was not assigned a compile-time constant value"})]})]})})]}),"\n",(0,c.jsx)(l.h2,{id:"conditionals",children:"Conditionals"}),"\n",(0,c.jsx)(l.p,{children:"If there is certain code you only want to have compiled in for a certain build, such as a debug build, you can use compile-time conditionals:"}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsxs)(l.code,{children:[(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$define"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" DEBUG "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"true"})]}),(0,c.jsx)(l.div,{className:"line"}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$if"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" DEBUG "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"then"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"    "}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"print"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"Script running in debug mode"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"})]}),(0,c.jsx)(l.div,{className:"line",children:(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$else"})}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"    "}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"print"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"Script running in release mode"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"})]}),(0,c.jsx)(l.div,{className:"line",children:(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$end"})})]})})]}),"\n",(0,c.jsx)(l.p,{children:"In this case, only one of the two paths will be compiled in; the rest will not take up any space."}),"\n",(0,c.jsx)(l.h2,{id:"aliases",children:"Aliases"}),"\n",(0,c.jsx)(l.p,{children:"Preprocessor aliases are similar to C/C++ macros. For example, you can define an alias for a keyword:"}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsxs)(l.code,{children:[(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$alias"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" let "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"local"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"let a "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"1"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"print"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"(a) "}),(0,c.jsx)(l.span,{style:{color:"#88846F"},children:"--\x3e 1"})]})]})})]}),"\n",(0,c.jsx)(l.p,{children:"or write simple functions which will be fully inlined at the call site:"}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsxs)(l.code,{children:[(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$alias"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#A6E22E"},children:"add"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#FD971F",fontStyle:"italic"},children:"a"}),(0,c.jsx)(l.span,{style:{color:"#9F570F"},children:","}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#FD971F",fontStyle:"italic"},children:"b"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:") "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" a "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"+"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" b"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"assert"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"add"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"1"}),(0,c.jsx)(l.span,{style:{color:"#9F570F"},children:","}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"2"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:") "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"=="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#AE81FF"},children:"3"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"})]})]})})]}),"\n",(0,c.jsx)(l.p,{children:"If you want to write an alias over multiple lines, you can use a backslash to continue it:"}),"\n",(0,c.jsxs)(l.pre,{className:"shiki monokai",style:{backgroundColor:"#272822",color:"#F8F8F2"},children:[(0,c.jsx)(l.div,{className:"language-id",children:"pluto"}),(0,c.jsx)(l.div,{className:"code-container",children:(0,c.jsxs)(l.code,{children:[(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"$alias"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" seq "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"a"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"  \\"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"             "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:".."}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"   \\"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"             "}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"b"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"  \\"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"             "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:".."}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"   \\"})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"             "}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"c"'})]}),(0,c.jsxs)(l.div,{className:"line",children:[(0,c.jsx)(l.span,{style:{color:"#66D9EF"},children:"assert"}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:"(seq "}),(0,c.jsx)(l.span,{style:{color:"#F92672"},children:"=="}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:" "}),(0,c.jsx)(l.span,{style:{color:"#E6DB74"},children:'"abc"'}),(0,c.jsx)(l.span,{style:{color:"#F8F8F2"},children:")"})]})]})})]})]})}function F(s={}){const{wrapper:l}={...(0,o.R)(),...s.components};return l?(0,c.jsx)(l,{...s,children:(0,c.jsx)(t,{...s})}):t(s)}}}]);